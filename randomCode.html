<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>random code demo</title>
    <style>
        #verificationCode {
            text-align: center;
            vertical-align: middle;
            margin: 300px auto;
            width: 500px;
            height: 50px;
            background-color: white;
        }

        #input {
            display: inline-block;
            outline: none;
        }

        #codeCanvas {
            display: inline-block;
            background-color: whitesmoke;
            letter-spacing: 5px;
        }

        #btn {
            display: inline-block;
            width: 50px;
            height: 30px;
            border: none;
            background-color: darkseagreen;
            color: white;
            font-size: 13px;
        }
    </style>
</head>
<body onload="createRandomCode()">
<div id="verificationCode">
    <input id="input" type="text" placeholder="请输入验证码">
    <canvas id="codeCanvas" width="80px" height="30px" onclick="createRandomCode(this)"></canvas>
    <button id="btn" type="submit" onclick="verifyRandomCode()">提交</button>
    <p id="line"></p>
</div>

<script>
    function createRandomCode() {
        //全局变量code
        code = "";
        let numsAndLetters = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']
        for (let i = 0; i < 4; i++) {
            code += numsAndLetters[Math.floor(Math.random() * 36)];
        }

        let codeCanvas = document.getElementById("codeCanvas");
        if (codeCanvas.getContext) {
            let ctx = codeCanvas.getContext('2d');
            ctx.fillStyle = "whitesmoke"
            ctx.font = "20px Arial";
            ctx.fillRect(0, 0, codeCanvas.width, codeCanvas.height);
            ctx.strokeText(code, 8, 20);
        }
        console.log(code);
    }

    function verifyRandomCode() {
        let input = document.getElementById("input").value.toUpperCase();
        let line = document.getElementById("line");
        console.log(input);
        if (code == input) {
            line.innerText = " ";
            window.open('http://www.google.com', '_self');
        } else {
            line.innerText = "验证码错误";
        }
        createRandomCode();
    }
</script>
</body>
</html>